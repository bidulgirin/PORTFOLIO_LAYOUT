<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- three.js -->
    
    <title>Document</title>
    <style>
        .html,body{
            margin:0;
            padding:0;
        }
    </style>
</head>
<body>
    <div id="container" style="height:100vh;"></div>
    <div style="height:100vh;">hello!</div>
    <script type="module">
        import * as THREE from 'https://cdn.skypack.dev/three@0.129.0/build/three.module.js';
        import Stats from 'https://cdn.skypack.dev/three@0.129.0/examples/jsm/libs/stats.module.js';
        import { OrbitControls } from 'https://cdn.skypack.dev/three@0.129.0/examples/jsm/controls/OrbitControls.js';
        import { GLTFLoader } from 'https://cdn.skypack.dev/three@0.129.0/examples/jsm/loaders/GLTFLoader.js';


        const container = document.getElementById( 'container' );
        const scene = new THREE.Scene();
        const loader = new GLTFLoader();

        const camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 );
        const renderer = new THREE.WebGLRenderer();

        renderer.setSize( window.innerWidth, window.innerHeight );
        const light = new THREE.AmbientLight( 0xffffff ); // soft white light
        const stats = new Stats();
		container.appendChild( stats.dom );

        const geometry = new THREE.BoxGeometry( 1, 1, 1 );
        const material = new THREE.MeshBasicMaterial( { color: 0xffffff } );
        
        camera.position.set( 5, 2, 8 );

        light.position.z = 1;

        scene.add( light );
        scene.background = new THREE.Color( 0xbfe3dd );
        container.appendChild( renderer.domElement );
        let mixer;
        
        loader.load( 'blender/scene.gltf', function ( object ) {
           
            const drone = object.scene;
            drone.position.set( 5, 2, 5);
            drone.castShadow = true;
            drone.receiveShadow = true;
            scene.add( drone );

            mixer = new THREE.AnimationMixer(drone);
            console.log(object.animations[0]);
            const action = [];
            mixer.clipAction(object.animations[ 0 ] ).play();
        });

        const clock = new THREE.Clock();
        function animate() {
            const delta = clock.getDelta();
            if(mixer){mixer.update(delta);}
            requestAnimationFrame( animate );
            renderer.render( scene, camera );
            renderer.setAnimationLoop(animate);
        }
        animate();
        const controls = new OrbitControls(camera, renderer.domElement);
        
    </script>
</body>
</html>